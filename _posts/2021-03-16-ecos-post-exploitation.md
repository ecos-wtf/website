---
layout: post
title: Broadcom eCOS | Post-exploitation Moves
description: Interesting commands and features of Broadcom eCOS systems implemented by ISPs and vendors.
summary: Interesting commands and features of Broadcom eCOS systems implemented by ISPs and vendors.
author: qkaiser
date: 2021-03-16 09:00:00
tags: [ecos, broadcom, commands]
---

Let's document interesting commands and features of Broadcom eCOS systems implemented by ISPs and vendors.

### Network

#### ping sweep

{% highlight plain %}
RG> /Console/pingHelper/ip_sweep 255.255.255.0 192.168.22.1

Trying address 192.168.22.1...OK!
Trying address 192.168.22.2...no response.
Trying address 192.168.22.3...no response.
Trying address 192.168.22.4...no response.
Trying address 192.168.22.5...no response.
Trying address 192.168.22.6...no response.
{% endhighlight %}

#### traffic capture (serial)

You can log all packets to serial with the pktlog command:

{% highlight plain %}
RG> /Console/system/pktlog true

Ethernet Frame Header:  (Format is Ethernet II/DIX)
DestAddr=01:00:5e:7f:ff:fa; SrcAddr=08:6a:0a:f1:80:d0; EtherType=0x800 (IP) Merged protocol = 0x10800

IP Frame Header:
Ver=4; ProtType=17 (UDP); DestIP=239.255.255.250; SrcIP=192.168.2.1

TCP/UDP Frame Header:  DestPort=1900 (0x76c); SrcPort=1901 (0x76d)

Raw buffer octets:  (338 bytes)

01 00 5e 7f   ff fa 08 6a   0a f1 80 d0   08 00 45 00  | ..^....j......E.
01 44 de ad   00 00 04 11   24 58 c0 a8   02 01 ef ff  | .D......$X......
ff fa 07 6d   07 6c 01 30   29 cb 4e 4f   54 49 46 59  | ...m.l.0).NOTIFY
20 2a 20 48   54 54 50 2f   31 2e 31 0d   0a 48 4f 53  |  * HTTP/1.1..HOS
54 3a 20 32   33 39 2e 32   35 35 2e 32   35 35 2e 32  | T: 239.255.255.2
35 30 3a 31   39 30 30 0d   0a 43 61 63   68 65 2d 43  | 50:1900..Cache-C
6f 6e 74 72   6f 6c 3a 20   6d 61 78 2d   61 67 65 3d  | ontrol: max-age=
31 39 30 30   0d 0a 4c 6f   63 61 74 69   6f 6e 3a 20  | 1900..Location:
68 74 74 70   3a 2f 2f 31   39 32 2e 31   36 38 2e 32  | http://192.168.2
2e 31 3a 38   30 2f 52 6f   6f 74 44 65   76 69 63 65  | .1:80/RootDevice
2e 78 6d 6c   0d 0a 4e 54   3a 20 75 75   69 64 3a 75  | .xml..NT: uuid:u
70 6e 70 2d   57 41 4e 43   6f 6e 6e 65   63 74 69 6f  | pnp-WANConnectio
6e 44 65 76   69 63 65 2d   31 5f 30 2d   30 38 36 61  | nDevice-1_0-086a
30 61 66 31   38 30 64 30   0d 0a 55 53   4e 3a 20 75  | 0af180d0..USN: u
75 69 64 3a   75 70 6e 70   2d 57 41 4e   43 6f 6e 6e  | uid:upnp-WANConn
65 63 74 69   6f 6e 44 65   76 69 63 65   2d 31 5f 30  | ectionDevice-1_0
2d 30 38 36   61 30 61 66   31 38 30 64   30 0d 0a 4e  | -086a0af180d0..N
54 53 3a 20   73 73 64 70   3a 61 6c 69   76 65 0d 0a  | TS: ssdp:alive..
53 65 72 76   65 72 3a 20   55 50 6e 50   2f 31 2e 30  | Server: UPnP/1.0
20 55 50 6e   50 2f 31 2e   30 20 55 50   6e 50 2d 44  |  UPnP/1.0 UPnP-D
65 76 69 63   65 2d 48 6f   73 74 2f 31   2e 30 0d 0a  | evice-Host/1.0..
0d 0a                                                  | ..
{% endhighlight %}

The problem is that on a live system, the output is so large that the device usually hangs after a few minutes.

#### traffic capture (Ethernet SPAN port)

On Netgear devices you have the ability to setup something similar to a SPAN port. It will copy all traffic transmitted over coaxial to the first Ethernet port.

Connect your machine to the device with an Ethernet cable on first port and launch wireshark.

### Credentials

Some commands to dump credentials:

{% highlight plain %}
/non-vol/userif/http_admin
/non-vol/userif/http_user
/non-vol/tr69/conn_req_password
/non-vol/tr69/acs_password
/non-vol/vendorui/show
{% endhighlight %}
